<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trainings Timer</title>

<link rel="manifest" href="manifest.json">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f7f7f7;
  padding: 20px;
  text-align: center;
}
body.glove { font-size: 1.4em; }
body.glove button {
  font-size: 1.4em;
  padding: 18px 30px;
}
h1 { margin-bottom: 10px; }

select, input {
  font-size: 1em;
  padding: 6px;
  margin: 4px;
}

#exercise { font-size: 1.6em; margin: 20px 0; }
#timer { font-size: 4em; margin: 20px 0; }
body.glove #timer { font-size: 6em; }

button {
  font-size: 1.1em;
  padding: 12px 22px;
  margin: 6px;
}

.exercise-row {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin: 6px 0;
}
.exercise-row input {
  width: 26%;
}
.exercise-row button {
  padding: 6px 10px;
  font-size: 1em;
}
hr { margin: 20px 0; }
</style>
</head>

<body>

<h1>Trainings Timer</h1>

<select id="day" onchange="loadDay()">
  <option>Maandag</option><option>Dinsdag</option><option>Woensdag</option>
  <option>Donderdag</option><option>Vrijdag</option>
  <option>Zaterdag</option><option>Zondag</option>
</select>

<br>
<button onclick="toggleGlove()">üß§ Handschoenmodus</button>

<h3>Instellingen</h3>
Rondes:
<input id="rondes" type="number" value="1" min="1" style="width:80px;">

<hr>

<h3>Presets</h3>
<input id="presetName" placeholder="Presetnaam"><br>

<select id="presetList" onchange="selectPreset()"></select><br>

<button onclick="savePreset()">üíæ Nieuwe preset</button>
<button onclick="updatePreset()">üîÅ Werk preset bij</button><br>
<button onclick="renamePreset()">‚úèÔ∏è Hernoem preset</button>
<button onclick="deletePreset()">üóëÔ∏è Verwijder preset</button>

<hr>

<h3>Oefeningen</h3>
<div id="exerciseList"></div>
<button onclick="addExercise()">‚ûï Oefening toevoegen</button>

<div id="exercise">Klaar om te starten</div>
<div id="timer">00:00</div>

<button onclick="startTimer()">Start</button>
<button onclick="pauseTimer()">Pauze</button>
<button onclick="resetTimer()">Reset</button>

<script>
let schema=[], index=0, ronde=1, fase="werk", resterend=0, interval=null;

/* ---------- GELUID ---------- */
function beep(freq=800,dur=0.15){
  const ctx=new (window.AudioContext||window.webkitAudioContext)();
  const o=ctx.createOscillator();
  o.frequency.value=freq; o.connect(ctx.destination);
  o.start(); o.stop(ctx.currentTime+dur);
}
function vibrate(ms=200){ if(navigator.vibrate) navigator.vibrate(ms); }

/* ---------- UI ---------- */
function toggleGlove(){ document.body.classList.toggle("glove"); }

/* ---------- OEFENINGEN ---------- */
function addExercise(data={naam:"",werk:40,rust:20}){
  const d=document.createElement("div");
  d.className="exercise-row";
  d.innerHTML=`
    <input placeholder="Naam" value="${data.naam}">
    <input type="number" value="${data.werk}">
    <input type="number" value="${data.rust}">
    <button onclick="this.parentNode.remove()">üóëÔ∏è</button>
  `;
  exerciseList.appendChild(d);
}
function renderExercises(list){
  exerciseList.innerHTML="";
  (list&&list.length?list:[{},{ }]).forEach(o=>addExercise(o));
}
function buildSchema(){
  schema=[];
  document.querySelectorAll(".exercise-row").forEach(r=>{
    const i=r.querySelectorAll("input");
    if(i[0].value.trim())
      schema.push({naam:i[0].value,werk:+i[1].value,rust:+i[2].value});
  });
}

/* ---------- DATA ---------- */
function getCurrentData(){
  return {
    rondes:rondes.value,
    oefeningen:[...document.querySelectorAll(".exercise-row")].map(r=>{
      const i=r.querySelectorAll("input");
      return {naam:i[0].value,werk:+i[1].value,rust:+i[2].value};
    })
  };
}
function applyData(d){
  rondes.value=d.rondes;
  renderExercises(d.oefeningen);
}

/* ---------- DAG ---------- */
function saveDay(){
  localStorage.setItem("day-"+day.value,JSON.stringify(getCurrentData()));
}
function loadDay(){
  const d=JSON.parse(localStorage.getItem("day-"+day.value));
  d?applyData(d):(rondes.value=1,renderExercises());
}

/* ---------- PRESETS ---------- */
function getPresets(){ return JSON.parse(localStorage.getItem("presets")||"{}"); }
function setPresets(p){ localStorage.setItem("presets",JSON.stringify(p)); }
function refreshPresetList(){
  presetList.innerHTML="";
  Object.keys(getPresets()).forEach(n=>{
    const o=document.createElement("option");
    o.textContent=n; presetList.appendChild(o);
  });
}
function selectPreset(){ presetName.value=presetList.value; }
function savePreset(){
  const n=presetName.value.trim(); if(!n) return alert("Naam ontbreekt");
  const p=getPresets();
  if(p[n]&&!confirm("Preset bestaat al. Overschrijven?")) return;
  p[n]=getCurrentData(); setPresets(p); refreshPresetList();
}
function updatePreset(){
  const n=presetList.value; if(!n) return alert("Selecteer preset");
  const p=getPresets(); p[n]=getCurrentData();
  setPresets(p); alert("Preset bijgewerkt");
}
function renamePreset(){
  const old=presetList.value, neu=presetName.value.trim();
  if(!old||!neu) return alert("Selecteer preset en nieuwe naam");
  const p=getPresets();
  if(p[neu]) return alert("Naam bestaat al");
  p[neu]=p[old]; delete p[old];
  setPresets(p); refreshPresetList(); presetList.value=neu;
}
function deletePreset(){
  const n=presetList.value;
  if(n&&confirm(`Preset "${n}" verwijderen?`)){
    const p=getPresets(); delete p[n];
    setPresets(p); refreshPresetList(); presetName.value="";
  }
}

/* ---------- TIMER ---------- */
function startTimer(){
  if(interval) return;
  saveDay(); buildSchema();
  if(!schema.length) return alert("Geen oefeningen");
  index=0; ronde=1; startWerk();
  interval=setInterval(tik,1000);
}
function pauseTimer(){ clearInterval(interval); interval=null; }
function resetTimer(){
  pauseTimer(); exercise.textContent="Klaar om te starten"; timer.textContent="00:00";
}
function startWerk(){
  fase="werk"; resterend=schema[index].werk;
  exercise.textContent=`${schema[index].naam} ‚Äì WERK (ronde ${ronde}/${rondes.value})`;
  beep(700); vibrate();
}
function startRust(){
  fase="rust"; resterend=schema[index].rust;
  exercise.textContent=`${schema[index].naam} ‚Äì RUST`;
  beep(500); vibrate(100);
}
function tik(){
  resterend--; updateTimer();
  if(resterend<=5&&resterend>0) beep(1200,0.08);
  if(resterend<=0){
    if(fase==="werk") startRust();
    else{
      index++;
      if(index>=schema.length){
        index=0; ronde++;
        if(ronde>rondes.value){
          resetTimer(); alert("Training klaar!"); beep(300,0.4); vibrate(400);
        } else startWerk();
      } else startWerk();
    }
  }
}
function updateTimer(){
  const m=Math.floor(resterend/60).toString().padStart(2,"0");
  const s=(resterend%60).toString().padStart(2,"0");
  timer.textContent=`${m}:${s}`;
}

loadDay(); refreshPresetList();
</script>

</body>
</html>


