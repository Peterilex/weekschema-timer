<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trainings Timer</title>

<link rel="manifest" href="manifest.json">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f7f7f7;
  padding: 20px;
  text-align: center;
}
body.glove {
  font-size: 1.4em;
}
body.glove button {
  font-size: 1.4em;
  padding: 18px 28px;
}
h1 { margin-bottom: 10px; }
select, input {
  font-size: 1em;
  padding: 5px;
  margin: 4px;
}
#exercise {
  font-size: 1.6em;
  margin: 20px 0;
}
#timer {
  font-size: 4em;
  margin: 20px 0;
}
body.glove #timer {
  font-size: 6em;
}
button {
  font-size: 1.1em;
  padding: 10px 20px;
  margin: 6px;
}
.exercise-row {
  margin: 6px 0;
}
.exercise-row input {
  width: 28%;
}
</style>
</head>

<body>

<h1>Trainings Timer</h1>

<select id="day" onchange="loadDay()">
  <option>Maandag</option>
  <option>Dinsdag</option>
  <option>Woensdag</option>
  <option>Donderdag</option>
  <option>Vrijdag</option>
  <option>Zaterdag</option>
  <option>Zondag</option>
</select>

<button onclick="toggleGlove()">ðŸ§¤ Handschoenmodus</button>

<h3>Oefeningen</h3>
<div id="exerciseList"></div>

<div id="exercise">Klaar om te starten</div>
<div id="timer">00:00</div>

<button onclick="startTimer()">Start</button>
<button onclick="pauseTimer()">Pauze</button>
<button onclick="resetTimer()">Reset</button>

<script>
let schema = [];
let index = 0;
let fase = "werk";
let resterend = 0;
let interval = null;

function beep(freq = 800, dur = 0.15) {
  const ctx = new AudioContext();
  const osc = ctx.createOscillator();
  osc.frequency.value = freq;
  osc.connect(ctx.destination);
  osc.start();
  osc.stop(ctx.currentTime + dur);
}

function vibrate(ms = 200) {
  if (navigator.vibrate) navigator.vibrate(ms);
}

function renderExercises(data) {
  exerciseList.innerHTML = "";
  (data || [
    { naam:"Squat", werk:40, rust:20 },
    { naam:"Hip hinge", werk:40, rust:20 },
    { naam:"Core", werk:30, rust:15 }
  ]).forEach(o => {
    const d = document.createElement("div");
    d.className = "exercise-row";
    d.innerHTML = `
      <input placeholder="Naam" value="${o.naam}">
      <input type="number" placeholder="Werk" value="${o.werk}">
      <input type="number" placeholder="Rust" value="${o.rust}">
    `;
    exerciseList.appendChild(d);
  });
}

function saveDay() {
  const d = day.value;
  const oefeningen = [...document.querySelectorAll(".exercise-row")].map(r => {
    const i = r.querySelectorAll("input");
    return { naam:i[0].value, werk:+i[1].value, rust:+i[2].value };
  });
  localStorage.setItem(d, JSON.stringify(oefeningen));
}

function loadDay() {
  const d = day.value;
  const data = JSON.parse(localStorage.getItem(d));
  renderExercises(data);
}

function buildSchema() {
  schema = [];
  document.querySelectorAll(".exercise-row").forEach(r => {
    const i = r.querySelectorAll("input");
    if (i[0].value.trim())
      schema.push({ naam:i[0].value, werk:+i[1].value, rust:+i[2].value });
  });
}

function startTimer() {
  if (interval) return;
  saveDay();
  buildSchema();
  if (!schema.length) return alert("Geen oefeningen");
  startWerk();
  interval = setInterval(tik, 1000);
}

function pauseTimer() {
  clearInterval(interval);
  interval = null;
}

function resetTimer() {
  pauseTimer();
  index = 0;
  fase = "werk";
  resterend = 0;
  exercise.textContent = "Klaar om te starten";
  timer.textContent = "00:00";
}

function startWerk() {
  fase = "werk";
  resterend = schema[index].werk;
  exercise.textContent = schema[index].naam + " â€“ WERK";
  beep(700); vibrate();
}

function startRust() {
  fase = "rust";
  resterend = schema[index].rust;
  exercise.textContent = schema[index].naam + " â€“ RUST";
  beep(500); vibrate(100);
}

function tik() {
  resterend--;
  updateTimer();

  if (resterend <= 5 && resterend > 0) {
    beep(1200, 0.08);
  }

  if (resterend <= 0) {
    if (fase === "werk") {
      startRust();
    } else {
      index++;
      if (index >= schema.length) {
        resetTimer();
        alert("Training klaar!");
        beep(300, 0.4); vibrate(400);
      } else {
        startWerk();
      }
    }
  }
}

function updateTimer() {
  const m = Math.floor(resterend / 60).toString().padStart(2,"0");
  const s = (resterend % 60).toString().padStart(2,"0");
  timer.textContent = `${m}:${s}`;
}

function toggleGlove() {
  document.body.classList.toggle("glove");
}

loadDay();
</script>

</body>
</html>
